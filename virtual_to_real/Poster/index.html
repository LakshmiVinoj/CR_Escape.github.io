<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>5-Shape Code Puzzle</title>
<style>
  :root{
    --bg:#0b0f14; --card:#111a24; --ink:#e8f0fb; --sub:#a9bfd7;
    --accent:#48b3ff; --ok:#37d67a; --bad:#ff5e6a;
  }

  html{
    font-size: 50px; /* 1rem = 50px */
  }

  html,body{
    height:100%;
    margin:0;
    background:linear-gradient(180deg,#081019,#0f1a26);
    color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial,sans-serif;
  }

  .wrap{
    min-height:100%;
    display:grid;
    place-items:center;
    padding:0.8rem; /* 40px */
  }

  .card{
    width:min(18rem,96vw); /* 900px max */
    background:var(--card);
    border:1px solid rgba(255,255,255,.07);
    border-radius:0.5rem;
    box-shadow:0 0.6rem 1.6rem rgba(0,0,0,.45);
    padding:0.8rem;
  }

  h1{
    margin:0 0 0.2rem;
    font-size:0.7rem; /* 35px */
    letter-spacing:.02rem;
  }

  p{
    margin:0 0 0.6rem;
    color:var(--sub);
    font-size:0.4rem; /* 20px */
    line-height:1.4;
  }

  .row{
    display:flex;
    gap:0.4rem;
    justify-content:center;
    flex-wrap:wrap;
  }

  /* Code slots */
  .slots{
    margin:0.5rem 0 0.6rem;
  }

  .slot{
    width:2.2rem;   /* 110px */
    height:2.2rem;
    border-radius:0.4rem;
    background:#0e1722;
    display:grid;
    place-items:center;
    border:0.05rem dashed rgba(255,255,255,.14);
  }

  .slot svg{
    width:1.5rem; /* 75px */
    height:1.5rem;
  }

  /* Shape buttons */
  button.shape{
    display:flex;
    align-items:center;
    gap:0.3rem;
    cursor:pointer;
    border:1px solid rgba(255,255,255,.14);
    border-radius:0.35rem;
    background:#0d1520;
    color:var(--ink);
    padding:0.35rem 0.5rem;
    font-weight:600;
    font-size:0.45rem; /* ~22px */
    min-height:1.3rem;
    transition:filter .2s ease, transform .06s ease;
  }

  button.shape svg{
    width:0.8rem;
    height:0.8rem;
  }

  button.shape:hover{ filter:brightness(1.08); }
  button.shape:active{ transform:translateY(1px); }

  /* Actions */
  .actions{
    display:flex;
    gap:0.4rem;
    justify-content:center;
    margin-top:0.5rem;
  }

  .primary{
    cursor:pointer;
    border:0;
    border-radius:0.35rem;
    padding:0.35rem 0.6rem;
    font-weight:700;
    font-size:0.45rem;
    background:var(--ok);
    color:#062913;
  }

  .ghost{
    cursor:pointer;
    border:1px solid rgba(255,255,255,.14);
    background:transparent;
    color:var(--ink);
    border-radius:0.35rem;
    padding:0.35rem 0.6rem;
    font-weight:600;
    font-size:0.45rem;
  }

  .error{
    text-align:center;
    color:var(--bad);
    min-height:0.6rem;
    margin-top:0.4rem;
    font-size:0.4rem;
  }

  .shake{ animation:shake .35s linear; }

  @keyframes shake{
    10%,90%{ transform:translateX(-0.05rem); }
    20%,80%{ transform:translateX(0.1rem); }
    30%,50%,70%{ transform:translateX(-0.14rem); }
    40%,60%{ transform:translateX(0.14rem); }
  }

  .c-hex { fill:#48e0a4; }
  .c-tri { fill:#48b3ff; }
  .c-rect{ fill:#ffd166; }
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="card">
    <h1>Enter the 5-shape code</h1>
    <p>Click a shape to append it to the code (5 slots). Then press <b>Check</b>.</p>

    <div class="row slots" id="slots" aria-live="polite">
      <div class="slot" data-idx="0"></div>
      <div class="slot" data-idx="1"></div>
      <div class="slot" data-idx="2"></div>
      <div class="slot" data-idx="3"></div>
      <div class="slot" data-idx="4"></div>
    </div>

    <div class="row shapes">
      <button class="shape" data-shape="hex" aria-label="Add hexagon">
        <!-- Fixed, perfectly fitting hexagon -->
        <svg viewBox="0 0 100 100"><polygon class="c-hex" points="50,5 93,28 93,72 50,95 7,72 7,28"/></svg>
        Hexagon
      </button>
      <button class="shape" data-shape="tri" aria-label="Add triangle">
        <svg viewBox="0 0 100 100"><polygon class="c-tri" points="50,10 95,90 5,90"/></svg>
        Triangle
      </button>
      <button class="shape" data-shape="rect" aria-label="Add rectangle">
        <svg viewBox="0 0 100 100"><rect class="c-rect" x="15" y="30" width="70" height="40" rx="6"/></svg>
        Rectangle
      </button>
    </div>

    <div class="actions">
      <button id="resetBtn" class="ghost" type="button">Reset</button>
      <button id="checkBtn" class="primary" type="button">Check</button>
    </div>

    <div class="error" id="msg" role="status" aria-live="polite"></div>

    <audio id="sndOK" src="correct.mp3" preload="auto"></audio>
    <audio id="sndNo" src="wrong.mp3" preload="auto"></audio>
  </div>
</div>

<script>
  const SECRET_CODE = ['rect','tri','rect','hex','rect'];
  const NEXT_PAGE   = 'shape-output.html';
  const MAX_LEN = 5;

  const slots = [...document.querySelectorAll('.slot')];
  const msg = document.getElementById('msg');
  const card = document.getElementById('card');
  const sndOK = document.getElementById('sndOK');
  const sndNo = document.getElementById('sndNo');

  const code = [];
  const icons = {
    hex:'<svg viewBox="0 0 100 100"><polygon class="c-hex" points="50,5 93,28 93,72 50,95 7,72 7,28"/></svg>',
    tri:'<svg viewBox="0 0 100 100"><polygon class="c-tri" points="50,10 95,90 5,90"/></svg>',
    rect:'<svg viewBox="0 0 100 100"><rect class="c-rect" x="15" y="30" width="70" height="40" rx="6"/></svg>'
  };

  function render(){
    slots.forEach((s,i)=>{
      s.innerHTML = code[i] ? icons[code[i]] : '';
      s.style.borderStyle = code[i] ? 'solid' : 'dashed';
    });
  }
  function addShape(kind){
    if (code.length >= MAX_LEN){
      msg.textContent = "Code is full. Use Reset to try a different sequence.";
      shake();
      return;
    }
    code.push(kind);
    msg.textContent = "";
    render();
  }
  function arraysEqual(a,b){ return a.length === b.length && a.every((v,i)=>v===b[i]); }
  function shake(){ card.classList.remove('shake'); void card.offsetWidth; card.classList.add('shake'); }
  function reset(){ code.length = 0; msg.textContent = ""; render(); }

  document.querySelectorAll('button.shape').forEach(btn=>{
    btn.addEventListener('click', ()=> addShape(btn.dataset.shape));
  });
  document.getElementById('resetBtn').addEventListener('click', reset);

  document.getElementById('checkBtn').addEventListener('click', async ()=>{
    msg.textContent = "";
    if (code.length < MAX_LEN){
      msg.textContent = "Enter all 5 shapes.";
      shake();
      return;
    }
    if (arraysEqual(code, SECRET_CODE)){
      try{
        const p = sndOK.play(); if (p) await p.catch(()=>{});
        const go = () => window.location.href = NEXT_PAGE;
        sndOK.onended = go; setTimeout(go, 900);
      }catch{ window.location.href = NEXT_PAGE; }
    }else{
      msg.textContent = "Incorrect sequence. Try again!";
      try{ const p = sndNo.play(); if (p) await p.catch(()=>{}); }catch{}
      shake();
    }
  });

  render();
</script>
</body>
</html>
